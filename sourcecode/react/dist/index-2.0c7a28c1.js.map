{"version":3,"sources":["index-2.js"],"names":["Component","props","state","stateChange","Object","assign","renderComponent","h","tag","attrs","children","React","element","setComponentProps","component","base","componentWillMount","componentWillReceiveProps","createComponent","inst","prototype","render","constructor","vnode","container","appendChild","_render","undefined","String","textNode","document","createTextNode","dom","createElement","keys","forEach","key","value","setAttribute","child","name","test","toLowerCase","style","cssText","removeAttribute","ReactDOM","innerHTML","Welcome","Demo","a","setState","console","log","handleAdd","bind","tick","getElementById","renderer","componentWillUpdate","componentDidUpdate","componentDidMount","parentNode","replaceChild","_component"],"mappings":"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","file":"index-2.0c7a28c1.js","sourceRoot":"..","sourcesContent":["class Component {\n  constructor(props = {}) {\n    this.state = {};\n    this.props = props;\n  }\n  setState(stateChange) {\n    // 将修改合并到state\n    Object.assign(this.state, stateChange);\n    renderComponent(this);\n  }\n}\nfunction h(tag, attrs, ...children) {\n  return {\n    tag,\n    attrs,\n    children\n  }\n}\n// 将上文定义的 h 方法放到对象React中\nconst React = {\n  h\n}\n\nconst element = (\n  <div>\n    hello<span>world!</span>\n  </div>\n);\n// set props\nfunction setComponentProps(component, props) {\n  if (!component.base) {\n    if (component.componentWillMount) component.componentWillMount();\n  } else if (component.componentWillReceiveProps) {\n    component.componentWillReceiveProps(props);\n  }\n  component.props = props;\n\n  renderComponent(component);\n\n}\n// 创建组件\nfunction createComponent(component, props) {\n  let inst;\n  // 如果是类定义组件，则直接返回实例\n  if (component.prototype && component.prototype.render) {\n    inst = new component(props);\n    // 如果是函数定义组件，则将其扩展为类定义组件\n  } else {\n    inst = new Component(props);\n    inst.constructor = component;\n    inst.render = function () {\n      // 返回 function 节点\n      return this.constructor(props);\n    }\n  }\n\n  return inst;\n}\n/**\n * \n * @param {*} vnode \n * @param {*} container \n * 递归插入节点\n */\nfunction render(vnode, container) {\n  return container.appendChild(_render(vnode));\n}\n\nfunction _render(vnode) {\n  if (typeof vnode.tag === 'function') {\n    const component = createComponent(vnode.tag, vnode.attrs);\n    setComponentProps(component, vnode.attrs);\n    return component.base;\n  }\n  if (vnode === undefined || vnode === null || typeof vnode === 'boolean') vnode = '';\n  if (typeof vnode === 'number') vnode = String(vnode);\n  if (typeof vnode === 'string') {\n    let textNode = document.createTextNode(vnode);\n    return textNode;\n  }\n  const dom = document.createElement(vnode.tag);\n  if (vnode.attrs) {\n    Object.keys(vnode.attrs).forEach(key => {\n      const value = vnode.attrs[key];\n      setAttribute(dom, key, value);\n    });\n  }\n  vnode.children.forEach(child => render(child, dom));    // 递归渲染子节点\n  return dom;\n}\nfunction setAttribute(dom, name, value) {\n  // 如果属性名是className，则改回class\n  if (name === 'className') name = 'class';\n\n  // 如果属性名是onXXX，则是一个事件监听方法\n  if (/on\\w+/.test(name)) {\n    name = name.toLowerCase();\n    dom[name] = value || '';\n    // 如果属性名是style，则更新style对象\n  } else if (name === 'style') {\n    if (!value || typeof value === 'string') {\n      dom.style.cssText = value || '';\n    } else if (value && typeof value === 'object') {\n      for (let name in value) {\n        // 可以通过style={ width: 20 }这种形式来设置样式，可以省略掉单位px\n        dom.style[name] = typeof value[name] === 'number' ? value[name] + 'px' : value[name];\n      }\n    }\n    // 普通属性则直接更新属性\n  } else {\n    // if ( name in dom ) {\n    //     dom[ name ] = value || '';\n    // }\n    if (value) {\n      dom.setAttribute(name, value);\n    } else {\n      dom.removeAttribute(name);\n    }\n  }\n}\nconst ReactDOM = {\n  render: (vnode, container) => {\n    container.innerHTML = '';\n    return render(vnode, container);\n  }\n}\nfunction Welcome() {\n  return (\n    <div>\n      <h1>head</h1>\n      Welcome\n    </div>\n  )\n}\nclass Demo extends Component {\n  constructor(props) {\n    super(props)\n    this.state = {\n      a: 1\n    }\n  }\n  handleAdd() {\n    let { a }  = this.state;\n    this.setState({\n      a: a\n    })\n    console.log(this.state, a);\n  }\n  render() {\n    return (\n      <div>\n        {this.state.a}\n        <button onClick={this.handleAdd.bind(this)}>\n        +\n      </button>\n      </div>\n      \n    )\n  }\n}\nfunction tick() {\n  ReactDOM.render(\n    <div>\n      <Demo />\n    <Welcome />\n    </div>,\n    document.getElementById('root')\n  );\n}\n\n// setInterval( tick, 1000 );\ntick()\nfunction renderComponent(component) {\n  let base;\n  const renderer = component.render();\n  if (component.base && component.componentWillUpdate) {\n    component.componentWillUpdate();\n  }\n  base = _render(renderer);\n  if (component.base) {\n    if (component.componentDidUpdate) component.componentDidUpdate();\n  } else if (component.componentDidMount) {\n    component.componentDidMount();\n  }\n  console.log(component.base && component.base.parentNode);\n  if (component.base && component.base.parentNode) {\n    console.log(1, base);\n    component.base.parentNode.replaceChild(base, component.base);\n  }\n  component.base = base;\n  base._component = component;\n}"]}