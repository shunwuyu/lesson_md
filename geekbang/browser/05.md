# 渲染流程（上）：HTML、CSS和JavaScript，是如何变成页面的？


“看透”页面是如何工作的

渲染流程
html, css, js , 经过浏览器现实漂亮的页面，
左边输入的是 HTML、CSS、JavaScript 数据，这些数据经过中间渲染模块的处理，最终输出为屏幕上的像素。
 
HTML   超文本标记语言
CSS    层叠样式表
JS      JavaScript    p.tyle.color = "gray"

HTML 的内容是由标记和文本组成 标签
浏览器会根据标签的语义来正确展示 HTML 内容

渲染流水线   子阶段

webpack chain 

构建 DOM 树   over
样式计算   Recalculate Style
布局阶段
分层
绘制
分块
光栅化
合成

开始每个子阶段都有其输入的内容；   然后每个子阶段有其处理过程； 最终每个子阶段会生成输出内容。

浏览器无法直接理解和使用 HTML，所以需要将 HTML 转换为浏览器能够理解的结构——DOM 树 (数据结构， 编程)

节点 父子节点 (查找 快)

构建 DOM 树的输入内容是一个非常简单的 HTML 文件
，然后经由 HTML 解析器解析  最终输出树状结构的 DOM。
document

document 就是 DOM 结构，   
DOM 是保存在内存中树状结构  JavaScript 来查询或修改其内容

1. 把 CSS 转换为浏览器能够理解的结构

浏览器也是无法直接理解这些纯文本的 CSS 样式
当渲染引擎接收到 CSS 文本时，会执行一个转换操作，将 CSS 文本转换为浏览器可以理解的结构——styleSheets
document.stylesheets

2. 转换样式表中的属性值，使其标准化
2em 被解析成了 32px  
rgb(255,0,0)
bold 700

3.  DOM树中每个节点的具体样式
CSS 的继承规则和层叠规则了。
所有子节点都继承了父节点样式。比如 body 节点的 font-size 属性是 20，那 body 节点下面的所有节点的 font-size 都等于 20。

层叠是 CSS 的一个基本特征，它是一个定义了如何合并来自多个源的属性值的算法

布局阶段
DOM 元素的几何位置信息
那么接下来就需要计算出 DOM 树中可见元素的几何位置，我们把这个计算过程叫做布局

1. 创建布局树

1. 遍历 DOM 树中的所有可见节点，并把这些节点加到布局树中；
而不可见的节点会被布局树忽略掉，如 head 标签下面的全部内容，再比如 body.p.span 这个元素，因为它的属性包含 dispaly:none，所以这个元素也没有被包进布局树。

2. 布局计算
布局树节点的坐标位置了。布局的计算过程非常复杂，我们这里先跳过不讲，等到后面章节中我再做详细的介绍
会把布局运算的结果重新写回布局树中

DOM 生成、样式计算和布局。

浏览器不能直接理解 HTML 数据，所以第一步需要将其转换为浏览器能够理解的 DOM 树结构；生成 DOM 树后，还需要根据 CSS 样式表，来计算出 DOM 树所有节点的样式；最后计算 DOM 元素的布局信息，使其都保存在布局树中。

如果下载 CSS 文件阻塞了，会阻塞 DOM 树的合成吗？会阻塞页面的显示吗？
1 不会阻塞dom树的构建，原因Html转化为dom树的过程，发现文件请求会交给网络进程去请求对应文件，渲染进程继续解析Html。
2 会阻塞页面的显示，当计算样式的时候需要等待css文件的资源进行层叠样式。资源阻塞了，会进行等待，直到网络超时，network直接报出相应错误，渲染进程继续层叠样式计算





